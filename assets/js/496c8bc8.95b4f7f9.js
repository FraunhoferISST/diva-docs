"use strict";(self.webpackChunkdiva_docs=self.webpackChunkdiva_docs||[]).push([[2710],{3905:function(e,t,n){n.d(t,{Zo:function(){return u},kt:function(){return m}});var a=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var c=a.createContext({}),s=function(e){var t=a.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},u=function(e){var t=s(e.components);return a.createElement(c.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},p=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,r=e.originalType,c=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),p=s(n),m=i,f=p["".concat(c,".").concat(m)]||p[m]||d[m]||r;return n?a.createElement(f,o(o({ref:t},u),{},{components:n})):a.createElement(f,o({ref:t},u))}));function m(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=n.length,o=new Array(r);o[0]=p;var l={};for(var c in t)hasOwnProperty.call(t,c)&&(l[c]=t[c]);l.originalType=e,l.mdxType="string"==typeof e?e:i,o[1]=l;for(var s=2;s<r;s++)o[s]=n[s];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}p.displayName="MDXCreateElement"},8920:function(e,t,n){n.r(t),n.d(t,{assets:function(){return u},contentTitle:function(){return c},default:function(){return m},frontMatter:function(){return l},metadata:function(){return s},toc:function(){return d}});var a=n(7462),i=n(3366),r=(n(7294),n(3905)),o=["components"],l={id:"policies",title:"Policies"},c="Policies",s={unversionedId:"Development/Data Governance/policies",id:"Development/Data Governance/policies",title:"Policies",description:"WIP",source:"@site/docs/04-Development/05-Data Governance/02-policies.md",sourceDirName:"04-Development/05-Data Governance",slug:"/Development/Data Governance/policies",permalink:"/diva-docs/docs/next/Development/Data Governance/policies",draft:!1,tags:[],version:"current",sidebarPosition:2,frontMatter:{id:"policies",title:"Policies"},sidebar:"divaSidebar",previous:{title:"Data Governance",permalink:"/diva-docs/docs/next/Development/Data Governance/introduction"},next:{title:"Rules",permalink:"/diva-docs/docs/next/Development/Data Governance/rules"}},u={},d=[{value:"Basic Behaviour",id:"basic-behaviour",level:2},{value:"Structure of Policies",id:"structure-of-policies",level:2},{value:"scope",id:"scope",level:3},{value:"condition",id:"condition",level:3},{value:"templates",id:"templates",level:3},{value:"Business Decision Point",id:"business-decision-point",level:2},{value:"Securing a Service",id:"securing-a-service",level:2}],p={toc:d};function m(e){var t=e.components,n=(0,i.Z)(e,o);return(0,r.kt)("wrapper",(0,a.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"policies"},"Policies"),(0,r.kt)("p",null,"WIP"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"what they are for"),(0,r.kt)("li",{parentName:"ul"},"need for in-depth understanding of where to find data relevant to decision-making")),(0,r.kt)("h2",{id:"basic-behaviour"},"Basic Behaviour"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Forbidden-by-default"),(0,r.kt)("li",{parentName:"ul"},"Cache policies")),(0,r.kt)("h2",{id:"structure-of-policies"},"Structure of Policies"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'{\n    id: "policy:uuid:a229c1a9-9371-4d84-89b7-81b662250c7d",\n    title: "User can execute PATCH on itself (excluding roles and groups)",\n    description:\n      "The policy allows an user to edit own data, excluding the fields for roles and groups",\n    isActive: true,\n    isEditable: true,\n    scope: {\n      "headers.serviceName": "entity-management",\n      path: "^/users/user:uuid:[0-9a-f]{8}-[0-9a-f]{4}-[0-5][0-9a-f]{3}-[089ab][0-9a-f]{3}-[0-9a-f]{12}.*",\n      method: "PATCH",\n    },\n    condition: {\n      and: [\n        {\n          inputData: {\n            query: {\n              "headers.diva.actorId": "{{params.id}}",\n            },\n          },\n        },\n      ],\n    },\n    excludes: ["groups", "roles"],\n}\n')),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Field Name"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"id"),(0,r.kt)("td",{parentName:"tr",align:null},"Every entity has a random uuid. Use a ",(0,r.kt)("a",{parentName:"td",href:"https://www.uuidgenerator.net/"},"uuid-generator")," to generate a fresh uuid for new default policies.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"title"),(0,r.kt)("td",{parentName:"tr",align:null},"The title of the policy. The text should allow another person to quickly see what the policy is about.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"description"),(0,r.kt)("td",{parentName:"tr",align:null},"A more in-depth description of the policy. This field is optional, but can be used to e.g. explain under which conditions the policy allows requests.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"isActive"),(0,r.kt)("td",{parentName:"tr",align:null},"Boolean variable to switch policies on or off.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"isEditable"),(0,r.kt)("td",{parentName:"tr",align:null},"Boolean variable to make policies immutable. This is necessary, for example, for 'allow-all'-style policies for admins. If these are turned off, admins may not be able to edit policies and consequently lose access to the system.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"scope"),(0,r.kt)("td",{parentName:"tr",align:null},"An object describing the scope the policy applies to. This can be, for example, a specific endpoint. ",(0,r.kt)("a",{parentName:"td",href:"#scope"},"Below")," is a more detailed explanation of the object.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"condition"),(0,r.kt)("td",{parentName:"tr",align:null},"An object that describes what conditions must be met for the policy to allow the query. This object can become complex as it allows for chaining and different query types and mechanisms for entering data for decision making. ",(0,r.kt)("a",{parentName:"td",href:"#condition"},"Below")," is a more detailed explanation of the object.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"includes ",(0,r.kt)("strong",{parentName:"td"},"or")," excludes"),(0,r.kt)("td",{parentName:"tr",align:null},"Policies can also allow a query but, for example, display only a subset of the fields of the object associated with the query or allow only a few of them to be modified. You can use includes or excludes to specify which fields to include or exclude. Please note that you should not use includes and excludes in the same policy and that includes cause only the specified fields to be visible.")))),(0,r.kt)("h3",{id:"scope"},"scope"),(0,r.kt)("h3",{id:"condition"},"condition"),(0,r.kt)("h3",{id:"templates"},"templates"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"{{}}"),(0,r.kt)("li",{parentName:"ul"},"regex"),(0,r.kt)("li",{parentName:"ul"},"pipe-operator")),(0,r.kt)("h2",{id:"business-decision-point"},"Business Decision Point"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"caching"),(0,r.kt)("li",{parentName:"ul"},"re-caching"),(0,r.kt)("li",{parentName:"ul"},"include/exclude-chaining"),(0,r.kt)("li",{parentName:"ul"},"responses")),(0,r.kt)("h2",{id:"securing-a-service"},"Securing a Service"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"adding and activating policy middleware")),(0,r.kt)("h1",{id:"troubleshooting"},"Troubleshooting"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"admin has locked himself out"),(0,r.kt)("li",{parentName:"ul"},"forbidden in every request")))}m.isMDXComponent=!0}}]);