<!DOCTYPE html>
<html lang="en-US">
  <head>
    <link rel="icon" href="/logos/diva_logo_1000_1000.png"><title>Docker deployment | DIVA Guide</title><meta name="description" content="DIVA  Documentation"><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="generator" content="VuePress 2.0.0-beta.15">
    <link rel="preload" href="/diva-docs/assets/js/runtime~app.79a8b393.js" as="script"><link rel="preload" href="/diva-docs/assets/css/styles.58093299.css" as="style"><link rel="preload" href="/diva-docs/assets/js/772.2e113ebf.js" as="script"><link rel="preload" href="/diva-docs/assets/js/app.5c06d636.js" as="script">
    <link rel="stylesheet" href="/diva-docs/assets/css/styles.58093299.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><header class="navbar"><div class="toggle-sidebar-button"><svg class="icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><span><a href="/diva-docs/" class=""><img class="logo" src="/diva-docs//logos/diva_logo_1000_1000.png" alt="DIVA Guide"><span class="site-name can-hide">DIVA Guide</span></a></span><div class="navbar-links-wrapper" style=""><!--[--><!--]--><nav class="navbar-links can-hide"><!--[--><div class="navbar-links-item"><a href="/diva-docs/about/" class="nav-link" aria-label="About DIVA"><!--[--><!--]--> About DIVA <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/diva-docs/user-docs/" class="nav-link" aria-label="Users Guide"><!--[--><!--]--> Users Guide <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/diva-docs/deployment/" class="nav-link" aria-label="Deployment"><!--[--><!--]--> Deployment <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/diva-docs/development/" class="nav-link router-link-active" aria-label="Development"><!--[--><!--]--> Development <!--[--><!--]--></a></div><div class="navbar-links-item"><a class="nav-link external" href="https://github.com/FraunhoferISST/diva" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><div class="sidebar-mask"></div><aside class="sidebar"><nav class="navbar-links"><!--[--><div class="navbar-links-item"><a href="/diva-docs/about/" class="nav-link" aria-label="About DIVA"><!--[--><!--]--> About DIVA <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/diva-docs/user-docs/" class="nav-link" aria-label="Users Guide"><!--[--><!--]--> Users Guide <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/diva-docs/deployment/" class="nav-link" aria-label="Deployment"><!--[--><!--]--> Deployment <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/diva-docs/development/" class="nav-link router-link-active" aria-label="Development"><!--[--><!--]--> Development <!--[--><!--]--></a></div><div class="navbar-links-item"><a class="nav-link external" href="https://github.com/FraunhoferISST/diva" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-links"><!--[--><!--[--><a href="/diva-docs/development/" class="nav-link router-link-active sidebar-link" aria-label="Introduction"><!--[--><!--]--> Introduction <!--[--><!--]--></a><!----><!--]--><!--[--><a href="/diva-docs/development/prerequisites.html" class="nav-link sidebar-link" aria-label="Prerequisites"><!--[--><!--]--> Prerequisites <!--[--><!--]--></a><!----><!--]--><!--[--><section class="sidebar-group"><p class="sidebar-heading active">Development</p><ul class=""><li><!--[--><section class="sidebar-group"><p class="sidebar-heading active">Deployment</p><ul class="sidebar-sub-headers"><li><!--[--><a href="/diva-docs/development/deployment/local.html" class="nav-link sidebar-link" aria-label="Local development"><!--[--><!--]--> Local development <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/diva-docs/development/deployment/docker.html" class="router-link-active router-link-exact-active nav-link router-link-active sidebar-link active" aria-label="Docker deployment"><!--[--><!--]--> Docker deployment <!--[--><!--]--></a><ul class="sidebar-sub-headers"><li><!--[--><a aria-current="page" href="/diva-docs/development/deployment/docker.html#environment-variables" class="router-link-active router-link-exact-active nav-link sidebar-link" aria-label="Environment variables"><!--[--><!--]--> Environment variables <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/diva-docs/development/deployment/docker.html#container-and-images-management" class="router-link-active router-link-exact-active nav-link sidebar-link" aria-label="Container and images management"><!--[--><!--]--> Container and images management <!--[--><!--]--></a><ul class="sidebar-sub-headers"><li><!--[--><a aria-current="page" href="/diva-docs/development/deployment/docker.html#manage-microservices" class="router-link-active router-link-exact-active nav-link sidebar-link" aria-label="Manage microservices"><!--[--><!--]--> Manage microservices <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/diva-docs/development/deployment/docker.html#manage-faas" class="router-link-active router-link-exact-active nav-link sidebar-link" aria-label="Manage FaaS"><!--[--><!--]--> Manage FaaS <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/diva-docs/development/deployment/docker.html#manage-airflow" class="router-link-active router-link-exact-active nav-link sidebar-link" aria-label="Manage Airflow"><!--[--><!--]--> Manage Airflow <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/diva-docs/development/deployment/docker.html#manage-base-images" class="router-link-active router-link-exact-active nav-link sidebar-link" aria-label="Manage base images"><!--[--><!--]--> Manage base images <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--></li></ul><!--]--></li></ul></section><!--]--></li><li><!--[--><section class="sidebar-group"><p class="sidebar-heading">Architecture</p><ul class="sidebar-sub-headers"><li><!--[--><a href="/diva-docs/development/architecture/" class="nav-link sidebar-link" aria-label="Overview"><!--[--><!--]--> Overview <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/diva-docs/development/architecture/json-schemas.html" class="nav-link sidebar-link" aria-label="Schemata  "><!--[--><!--]--> Schemata   <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/diva-docs/development/architecture/rest-api.html" class="nav-link sidebar-link" aria-label="REST API"><!--[--><!--]--> REST API <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/diva-docs/development/architecture/keycloak.html" class="nav-link sidebar-link" aria-label="Keycloak"><!--[--><!--]--> Keycloak <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/diva-docs/development/architecture/gateway.html" class="nav-link sidebar-link" aria-label="Gateway"><!--[--><!--]--> Gateway <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/diva-docs/development/architecture/web-client.html" class="nav-link sidebar-link" aria-label="Web client"><!--[--><!--]--> Web client <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/diva-docs/development/architecture/tooling.html" class="nav-link sidebar-link" aria-label="Tooling"><!--[--><!--]--> Tooling <!--[--><!--]--></a><!----><!--]--></li></ul></section><!--]--></li></ul></section><!--]--><!--[--><section class="sidebar-group"><p class="sidebar-heading">Contribution</p><ul class=""><li><!--[--><a href="/diva-docs/development/contribution/" class="nav-link sidebar-link" aria-label="How you can help"><!--[--><!--]--> How you can help <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/diva-docs/development/contribution/issues-and-prs.html" class="nav-link sidebar-link" aria-label="Issues and pull request"><!--[--><!--]--> Issues and pull request <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/diva-docs/development/contribution/commits.html" class="nav-link sidebar-link" aria-label="Committing changes"><!--[--><!--]--> Committing changes <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/diva-docs/development/contribution/code-styles.html" class="nav-link sidebar-link" aria-label="Code style guidance"><!--[--><!--]--> Code style guidance <!--[--><!--]--></a><!----><!--]--></li></ul></section><!--]--><!--]--></ul><!--[--><!--]--></aside><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h1 id="docker-deployment"><a class="header-anchor" href="#docker-deployment">#</a> Docker deployment</h1><p>DIVA is built with a focus on scalability, modularisation and expandability using a microservice architecture. Our team relies on the latest technologies for container-based development and deployment of the system using Docker. All system components are containerized and have current images that are continuously built in the CI pipeline. In this guide we will learn how to get DIVA running with <code>docker-compose</code>.</p><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>Make sure to read the <a href="/diva-docs/development/deployment/" class="">prerequisites</a> to know what you need to get started with Docker and Docker Compose. Also note that deployment with docker is not suitable for Production. Nonetheless, it is convenient for local development environment to quickly spin up most of the components like Kafka, Gateway and other services.</p></div><p>All things related to docker are located in the <a href="https://github.com/FraunhoferISST/diva/blob/master/docker" target="_blank" rel="noopener noreferrer"><code>docker/</code><span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a> directory. Here we have prepared a script which you can use to directly boot all components, with default environment setup. If you need a quick start, just execute the following commands:</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token comment"># navigate to docker/ directory</span>
<span class="token builtin class-name">cd</span> docker
<span class="token comment"># spin up the system</span>
./up_core.sh
</code></pre></div><p>The script starts all core services, profiling workflow engine, DSC and the web client application. It may take some time until all components are up and running. By default, the client should be available on <code>localhost:70</code>.</p><p>If you want to learn more about the configuration options, the following chapters will show you how to manage Docker containers, images and deployment.</p><h2 id="environment-variables"><a class="header-anchor" href="#environment-variables">#</a> Environment variables</h2><p>First with the environment variables you have the possibility to propagate settings to the containers on run time. The ENV&#39;s are used to configure exposed ports, Kafka topics, database connections, credentials etc. This makes the deployment of containers more flexible and provides you a way to configure the environment without potential collisions with other software on your machines.</p><div class="custom-container warning"><p class="custom-container-title">Ports allocation</p><p>DIVA components allocate many default ports like 80, 3000 or 27017. To avoid potential conflicts on deployment, most of the allocated ports can be configured in <code>docker/.env</code> file.</p></div><p>All available configuration possibilities are listed in the <a href="https://github.com/FraunhoferISST/diva/blob/master/docker/.env.default" target="_blank" rel="noopener noreferrer"><code>docker/.env.default</code><span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a> file. This ENV template is used by default to boot the system with <code>up_core.sh</code> script. To override default settings, create a <code>.env</code> file in the <code>docker/</code> directory and copy the contents of <code>.env.default</code> to it. There you can adjust the deployment,<br> and e.g. change the port of the web application as follows:</p><div class="language-env ext-env"><pre class="language-env"><code>WEB_CLIENT_PORT=90
</code></pre></div><h2 id="container-and-images-management"><a class="header-anchor" href="#container-and-images-management">#</a> Container and images management</h2><p>Now we will briefly go through the lifecycle of containers and images, from configuration to deployment in the container registry. This chapter is interesting for those who want to actively participate in the development of the system or manage containers and images in a more granular way.</p><div class="custom-container warning"><p class="custom-container-title">Environment variables</p><p>Make sure to create <code>.env</code> file on your machine like described in <a href="#environment-variables">Environment variables</a></p></div><p>We will take a brief look at how to build, push, and pull images in general. Of course, this chapter only concerns the software we have created and containerized, external images like Kafka or Elasticsearch are not of interest to us. In general, you will find multiple Docker Compose files that have the following responsibilities:</p><ul><li><p><a href="https://github.com/FraunhoferISST/diva/blob/master/docker/docker-compose.yml" target="_blank" rel="noopener noreferrer"><code>docker-compose.yml</code><span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a> - the most interesting config file as it is a heart of the DIVA</p></li><li><p><a href="https://github.com/FraunhoferISST/diva/blob/master/docker/docker-compose.faas.yml" target="_blank" rel="noopener noreferrer"><code>docker-compose.faas.yml</code><span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a> - FaaS services configuration useful only for local development to build and test images</p></li><li><p><a href="https://github.com/FraunhoferISST/diva/blob/master/docker/docker-compose.airflow.yml" target="_blank" rel="noopener noreferrer"><code>docker-compose.airflow.yml</code><span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a> - Airflow configuration</p></li><li><p><a href="https://github.com/FraunhoferISST/diva/blob/master/docker/docker-compose.profiling.yml" target="_blank" rel="noopener noreferrer"><code>docker-compose.profiling.yml</code><span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a> - external profiling services used in our profiling workflows</p></li><li><p><a href="https://github.com/FraunhoferISST/diva/blob/master/docker/docker-compose.monitoring.yml" target="_blank" rel="noopener noreferrer"><code>docker-compose.monitoring.yml</code><span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a> - several helpful monitoring and debugging tools like Kibana that are not deployed within the system core</p></li><li><p><a href="https://github.com/FraunhoferISST/diva/blob/master/docker/docker-compose.dsc.yml" target="_blank" rel="noopener noreferrer"><code>docker-compose.dsc.yml</code><span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a> - DSC Service, for demonstration purpose only</p></li></ul><p>The folder also contains other Docker Compose configurations that have <code>.build</code> in the suffix. These can override the normal configurations to build an image locally explicitly from source. The difference with the <code>.build</code> configurations is that the services are executed in the context of the corresponding folder. Generally, the configuration can be overwritten as follows:</p><div class="language-bash ext-sh"><pre class="language-bash"><code>docker-compose -f docker-compose.build.yml build resource-management
</code></pre></div><h3 id="manage-microservices"><a class="header-anchor" href="#manage-microservices">#</a> Manage microservices</h3><p>All microservices and their dependencies are defined in <code>docker-compose.yml</code>. You will work with this file the most.</p><p><strong>Pull image</strong></p><p>Simply run the command:</p><div class="language-bash ext-sh"><pre class="language-bash"><code>docker-compose pull <span class="token operator">&lt;</span>service_name<span class="token operator">&gt;</span>
<span class="token comment"># for example</span>
docker-compose pull user-management
</code></pre></div><p><strong>Build image</strong></p><p>To explicitly build the image from source, specify the path to the override <code>.yml</code> :</p><div class="language-bash ext-sh"><pre class="language-bash"><code>docker-compose f docker-compose.yml -f docker-compose.override.yml build <span class="token operator">&lt;</span>service_name<span class="token operator">&gt;</span>
<span class="token comment"># for example</span>
docker-compose f docker-compose.yml -f docker-compose.override.yml build user-management
</code></pre></div><p><strong>Push image</strong></p><p>Push image to container registry:</p><div class="language-bash ext-sh"><pre class="language-bash"><code>docker-compose push <span class="token operator">&lt;</span>service_name<span class="token operator">&gt;</span>
<span class="token comment"># for example</span>
docker-compose push user-management
</code></pre></div><h3 id="manage-faas"><a class="header-anchor" href="#manage-faas">#</a> Manage FaaS</h3><p>All FaaS are defined in <code>docker-compose.faas.yml</code>.</p><p><strong>Pull image</strong></p><div class="language-bash ext-sh"><pre class="language-bash"><code>docker-compose -f docker-compose.faas.yml pull <span class="token operator">&lt;</span>service_name<span class="token operator">&gt;</span>
<span class="token comment"># for example</span>
docker-compose -f docker-compose.faas.yml pull text-keywords-extractor
</code></pre></div><p><strong>Build image</strong></p><p>To explicitly build the image from source, specify the path to the build <code>.yml</code> :</p><div class="language-bash ext-sh"><pre class="language-bash"><code>docker-compose -f docker-compose.faas.yml -f docker-compose.faas.build.yml build <span class="token operator">&lt;</span>service_name<span class="token operator">&gt;</span>
<span class="token comment"># for example</span>
docker-compose -f docker-compose.faas.yml -f docker-compose.faas.build.yml build text-keywords-extractor
</code></pre></div><p><strong>Push image</strong></p><p>Push image to container registry:</p><div class="language-bash ext-sh"><pre class="language-bash"><code>docker-compose -f docker-compose.faas.yml push text-keywords-extractor
<span class="token comment"># for example</span>
docker-compose -f docker-compose.faas.yml push text-keywords-extractor
</code></pre></div><h3 id="manage-airflow"><a class="header-anchor" href="#manage-airflow">#</a> Manage Airflow</h3><p>We use a slightly customized image for Airflow. The definitions for Airflow are specified in<code>docker-compose.airflow.yml</code>.</p><p><strong>Pull image</strong></p><div class="language-bash ext-sh"><pre class="language-bash"><code>docker pull ghcr.io/fraunhoferisst/diva/airflow:<span class="token operator">&lt;</span>version<span class="token operator">&gt;</span>
</code></pre></div><p><strong>Build image</strong></p><p>To explicitly build the image from source, specify the path to the build <code>.yml</code> :</p><div class="language-bash ext-sh"><pre class="language-bash"><code>docker-compose -f docker-compose.airflow.build.yml build airflow
</code></pre></div><p><strong>Push image</strong></p><p>Push image to container registry:</p><div class="language-bash ext-sh"><pre class="language-bash"><code>docker-compose -f docker-compose.airflow.yml push airflow
</code></pre></div><h3 id="manage-base-images"><a class="header-anchor" href="#manage-base-images">#</a> Manage base images</h3><p>We have several images that serve as the basis for our FaaS. They are located in <code>./base-images</code>, so first change the working directory:</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token builtin class-name">cd</span> base-images
</code></pre></div><p><strong>Pull image</strong></p><div class="language-bash ext-sh"><pre class="language-bash"><code>docker-compose pull <span class="token operator">&lt;</span>service_name<span class="token operator">&gt;</span>
<span class="token comment"># for example</span>
docker-compose pull base-python3
</code></pre></div><p><strong>Build image</strong></p><div class="language-bash ext-sh"><pre class="language-bash"><code>docker-compose build <span class="token operator">&lt;</span>service_name<span class="token operator">&gt;</span>
<span class="token comment"># for example</span>
docker-compose build base-python3
</code></pre></div><p><strong>Push image</strong></p><p>Push image to container registry:</p><div class="language-bash ext-sh"><pre class="language-bash"><code>docker-compose push <span class="token operator">&lt;</span>service_name<span class="token operator">&gt;</span>
<span class="token comment"># for example</span>
docker-compose push base-python3
</code></pre></div><!--]--></div><footer class="page-meta"><div class="meta-item edit-link"><a class="nav-link external meta-item-label" href="https://github.com/FraunhoferISST/diva/edit/main/development/deployment/docker.md" rel="noopener noreferrer" target="_blank" aria-label><!--[--><!--]-->  <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><!----><!----></footer><nav class="page-nav"><p class="inner"><span class="prev"> ← <a href="/diva-docs/development/deployment/local.html" class="nav-link" aria-label="Local development"><!--[--><!--]--> Local development <!--[--><!--]--></a></span><!----></p></nav><!--[--><!--]--></main></div><!----><!--]--></div>
    <script src="/diva-docs/assets/js/runtime~app.79a8b393.js" defer></script><script src="/diva-docs/assets/js/772.2e113ebf.js" defer></script><script src="/diva-docs/assets/js/app.5c06d636.js" defer></script>
  </body>
</html>
